<!doctype html><html><head><title>Is Rust a Good Language for Machine Learning?</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><script src=/js/toc.js></script>
<link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.e78ecf1f01bdd175a52616472d7f6c77fa0d72eb91b15a27ce24fb7d302a6aa2.css integrity="sha256-547PHwG90XWlJhZHLX9sd/oNcuuRsVonziT7fTAqaqI=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.e96cc014086ea3bea59fb4923f8c19d6b203a7af229ee5f9599c0a4cb90e3bbd.css integrity="sha256-6WzAFAhuo76ln7SSP4wZ1rIDp68inuX5WZwKTLkOO70=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"></head><body><div id=app><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://aspcompiler.github.io/><div class=nav-title>Li Chen's blog</div><div class=nav-subtitle>Share my research and learning.</div></a><div class=nav-link-list><a class="a-block nav-link-item false" href=/about>About</a>
<a class="a-block nav-link-item active" href=/posts>Posts</a>
<a class="a-block nav-link-item false" href=/categories>Categories</a>
<a class="a-block nav-link-item false" href=/tags>Tags</a>
<a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2023 Li Chen</div></div><div id=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- CATALOG -</center><ul><li><a href=#introduction onclick="onNavClick(`#introduction-nav`)" id=introduction-nav>Introduction</a></li><li><a href=#vector-databases onclick="onNavClick(`#vector-databases-nav`)" id=vector-databases-nav>Vector Databases</a></li><ul><li><a href=#const-generics onclick="onNavClick(`#const-generics-nav`)" id=const-generics-nav>Const generics</a></li></ul><li><a href=#frameworks onclick="onNavClick(`#frameworks-nav`)" id=frameworks-nav>Frameworks</a></li><li><a href=#references onclick="onNavClick(`#references-nav`)" id=references-nav>References</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item false" href=/about>About</a>
<a class="a-block drawer-menu-item active" href=/posts>Posts</a>
<a class="a-block drawer-menu-item false" href=/categories>Categories</a>
<a class="a-block drawer-menu-item false" href=/tags>Tags</a>
<a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a><div class=toc><div class=toc-content><center>- CATALOG -</center><ul><li><a href=#introduction onclick="onNavClick(`#introduction-nav`)" id=introduction-nav>Introduction</a></li><li><a href=#vector-databases onclick="onNavClick(`#vector-databases-nav`)" id=vector-databases-nav>Vector Databases</a></li><ul><li><a href=#const-generics onclick="onNavClick(`#const-generics-nav`)" id=const-generics-nav>Const generics</a></li></ul><li><a href=#frameworks onclick="onNavClick(`#frameworks-nav`)" id=frameworks-nav>Frameworks</a></li><li><a href=#references onclick="onNavClick(`#references-nav`)" id=references-nav>References</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://aspcompiler.github.io/>Li Chen's blog</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://aspcompiler.github.io/><div class=single-column-header-title>Li Chen's blog</div><div class=single-column-header-subtitle>Share my research and learning.</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>Is Rust a Good Language for Machine Learning?<div class=post-meta><time itemprop=datePublished>2023-09-04 08:09</time>
<i class=material-icons>schedule</i>
1 min
49 s.</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><h1 id=introduction>Introduction</h1><p>Rust has been known for its performance and memory/thread safety. However, it takes an ecosystem to be successful. So far, Rust has found
a lot of success in network programming and bit coin mining. Rust has an excellent support for <code>async</code> making it a great language any time
we need distributed systems.</p><p>For the reason, Rust has found a lot of success in vector databases.</p><h1 id=vector-databases>Vector Databases</h1><p>There are several start-up companies that are building vector databases using Rust: <a href=https://www.pinecone.io/blog/rust-rewrite/>Pinecone</a>,
<a href=https://github.com/qdrant/qdrant>Qdrant</a> and <a href=https://fennel.ai/blog/vector-search-in-200-lines-of-rust/>Fennel.ai</a>.</p><h2 id=const-generics>Const generics</h2><p>Rust has an interesting feature called <a href=https://doc.rust-lang.org/reference/items/generics.html>const generics</a> that is uniquely suitable for vector databases. Const generics are generic arguments that range over constant values, rather than types or lifetimes. This allows, for instance, types to be parameterized by integers. The follow are some examples of const generics:</p><div class=highlight><div style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#228b22>// Examples where const generic parameters can be used.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#228b22>// Used in the signature of the item itself.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#8b008b;font-weight:700>fn</span> <span style=color:#008b45>foo</span>&lt;<span style=color:#8b008b;font-weight:700>const</span><span style=color:#bbb> </span>N: <span style=color:#00688b;font-weight:700>usize</span>&gt;(arr: [<span style=color:#00688b;font-weight:700>i32</span>;<span style=color:#bbb> </span>N])<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#228b22>// Used as a type within a function body.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#bbb>    </span><span style=color:#8b008b;font-weight:700>let</span><span style=color:#bbb> </span>x: [<span style=color:#00688b;font-weight:700>i32</span>;<span style=color:#bbb> </span>N];<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#228b22>// Used as an expression.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#bbb>    </span>println!(<span style=color:#cd5555>&#34;{}&#34;</span>,<span style=color:#bbb> </span>N<span style=color:#bbb> </span>*<span style=color:#bbb> </span><span style=color:#b452cd>2</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#228b22>// Used as a field of a struct.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#8b008b;font-weight:700>struct</span> <span style=color:#008b45;font-weight:700>Foo</span>&lt;<span style=color:#8b008b;font-weight:700>const</span><span style=color:#bbb> </span>N: <span style=color:#00688b;font-weight:700>usize</span>&gt;([<span style=color:#00688b;font-weight:700>i32</span>;<span style=color:#bbb> </span>N]);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#8b008b;font-weight:700>impl</span>&lt;<span style=color:#8b008b;font-weight:700>const</span><span style=color:#bbb> </span>N: <span style=color:#00688b;font-weight:700>usize</span>&gt;<span style=color:#bbb> </span>Foo&lt;N&gt;<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#228b22>// Used as an associated constant.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#bbb>    </span><span style=color:#8b008b;font-weight:700>const</span><span style=color:#bbb> </span>CONST: <span style=color:#00688b;font-weight:700>usize</span> =<span style=color:#bbb> </span>N<span style=color:#bbb> </span>*<span style=color:#bbb> </span><span style=color:#b452cd>4</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#8b008b;font-weight:700>trait</span><span style=color:#bbb> </span>Trait<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#8b008b;font-weight:700>type</span> <span style=color:#008b45;font-weight:700>Output</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#8b008b;font-weight:700>impl</span>&lt;<span style=color:#8b008b;font-weight:700>const</span><span style=color:#bbb> </span>N: <span style=color:#00688b;font-weight:700>usize</span>&gt;<span style=color:#bbb> </span>Trait<span style=color:#bbb> </span><span style=color:#8b008b;font-weight:700>for</span><span style=color:#bbb> </span>Foo&lt;N&gt;<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#228b22>// Used as an associated type.
</span></span></span><span style=display:flex><span><span style=color:#228b22></span><span style=color:#bbb>    </span><span style=color:#8b008b;font-weight:700>type</span> <span style=color:#008b45;font-weight:700>Output</span><span style=color:#bbb> </span>=<span style=color:#bbb> </span>[<span style=color:#00688b;font-weight:700>i32</span>;<span style=color:#bbb> </span>N];<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></td></tr></table></div></div><h1 id=frameworks>Frameworks</h1><p>Rust has been growing in machine learning frameworks as well, for example, Hugging Face <a href=https://github.com/huggingface/candle>candle</a> and <a href=https://github.com/burn-rs/burn>burn-rs</a>. Each of these frameworks can only run some models. For example, for <code>candle</code>, <a href=https://huggingface.co/spaces/lmz/candle-whisper>candle-whisper</a> and <a href=https://huggingface.co/spaces/lmz/candle-llama2>candle-llama2</a> and for <code>burn</code>, <a href=https://github.com/Gadersd/whisper-burn>whisper-burn</a> and <a href=https://github.com/Gadersd/llama2-burn>llama2-burn</a>.</p><p>These frameworks can work in spacial cases where frameworks like <code>PyTorch</code> are too large. For example, Candle&rsquo;s core goal is to make <code>serverless inference</code> possible.</p><p>This frameworks gave proof that Rust is a viable language for machine learning. They also built-up an ecosystem of Rust libraries that could be very useful for other Rust projects, for example, <a href=https://github.com/LaurentMazare/tch-rs>tch-rs</a>. Hugging Face also has <a href="https://github.com/huggingface?q=&type=all&language=rust&sort=">several tools developed in Rust</a>.</p><h1 id=references>References</h1><p>I have only touched a small part of machine learning in Rust. For more comprehensive reviews, please check out the following references:</p><ul><li><a href=https://www.arewelearningyet.com/>Are we learning yet</a></li><li><a href=Awesome-Rust-MachineLearning>Awesome-Rust-MachineLearning</a></li></ul><hr width=100% id=EOF><p style=color:#777>Last modified on 2023-09-04</p></div></div><nav class=post-pagination><a class=newer-posts>Next<br>No newer posts.</a>
<a class=older-posts href=/posts/practical-rust-ownership/>Previous<br>Practical Rust Ownership</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2023 Li Chen</div></div><script src=/js/journal.js></script></body></html>